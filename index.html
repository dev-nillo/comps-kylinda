<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfumes - Loja</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');
        body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0; background-color: #f4f4f4; }
        .container { width: 900px; max-width: 95vw; margin: auto; text-align: center; padding-top: 10px; transition: transform 0.5s; }
        header { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
        .icon-cart { position: relative; cursor: pointer; }
        .icon-cart svg { width: 35px; color: #353432; }
        .icon-cart span { position: absolute; top: -5px; right: -5px; width: 22px; height: 22px; background: red; color: white; border-radius: 50%; font-size: 12px; display: flex; align-items: center; justify-content: center; }
        .listProduct { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
    /* Substitua o .item antigo por este */
.item { 
    background: #353432; 
    padding: 20px; 
    border-radius: 20px; 
    color: white; 
    transition: 0.3s;
    
    /* Configuração para alinhar tudo */
    display: flex;
    flex-direction: column;
    justify-content: space-between; 
    min-height: 480px; /* Garante que todos os cards tenham o mesmo tamanho */
}

/* Adicione ou substitua estas também para alinhar os textos */
.item h2 {
    font-size: 1.1rem;
    height: 50px; /* Espaço fixo para o nome */
    margin: 10px 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.item p {
    font-size: 0.9rem;
    color: #ccc;
    height: 40px; /* Espaço fixo para a descrição */
    margin: 0 0 10px 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.item img { 
    width: 100%; 
    height: 180px; /* Altura fixa para a imagem não empurrar o texto */
    object-fit: contain; 
    filter: drop-shadow(0 15px 10px #0005); 
}
        .price { margin: 10px 0; font-weight: 600; color: #E8BC0E; font-size: 1.2rem; }
        .item button { background: white; color: #353432; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; width: 100%; }
        .cartTab { width: 400px; background: #353432; color: white; position: fixed; top: 0; right: -400px; bottom: 0; display: grid; grid-template-rows: 70px 1fr 70px; transition: right 0.5s; z-index: 1000; }
        body.showCart .cartTab { right: 0; }
        .listCart { overflow-y: auto; }
        .item-cart { display: grid; grid-template-columns: 1fr 80px 100px; align-items: center; gap: 10px; padding: 15px; border-bottom: 1px solid #444; }
        .quantity { display: flex; align-items: center; gap: 8px; }
        .quantity span { cursor: pointer; background: white; color: black; width: 20px; height: 20px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .btn { display: grid; grid-template-columns: 1fr 1fr; height: 70px; }
        .btn button { border: none; cursor: pointer; font-weight: bold; }
        .close { background: #ddd; }
        .buy { background: #E8BC0E; }
        .search-box { margin: 20px 0; }
        #searchInput { width: 100%; max-width: 500px; padding: 12px 20px; border-radius: 25px; border: 1px solid #ccc; outline: none; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="title" style="font-weight: 600; font-size: 1.5rem;">KYLINDA PERFUMARIA</div>
            <div class="icon-cart">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                <span>0</span>
            </div>
        </header>
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="O que você está procurando?">
        </div>
        <div class="listProduct"></div>
    </div>

    <div class="cartTab">
        <h1>Carrinho</h1>
        <div class="listCart"></div>
        <div class="btn">
            <button class="close">FECHAR</button>
            <button class="buy">FINALIZAR</button>
        </div>
    </div>

    <script>
        const produtos = [
            { id: 1, nome: "Uomini Tradicional", preco: 200, desc: "Masculino, 100ml", img: "imagens/produtos/uominitrad..png" },
            { id: 2, nome: "Uomini Black", preco: 200, desc: "Masculino, 100ml", img: "imagens/produtos/uominiblack.png" },
            { id: 3, nome: "Uomini Infinite", preco: 200, desc: "Masculino, 100ml", img: "imagens/produtos/uominiinf.png" },
            { id: 4, nome: "Egeo Vanilla Vibe", preco: 160, desc: "Feminino, 90ml", img: "imagens/produtos/egeovanvibe.png"},
            { id: 5, nome: "Egeo Dolce", preco: 160, desc: "Feminino, 90ml", img: "imagens/produtos/egeodolce.png"},
            { id: 6, nome: "Dream Viagem Encantada", preco: 110, desc: "Feminino, 200ml", img: "imagens/produtos/dreamviagem.png" },
            { id: 7, nome: "Floratta Gold", preco: 165, desc: "Feminino, 75ml", img: "imagens/produtos/florattagold.png" },
            { id: 8, nome: "Floratta Blue", preco: 165, desc: "Feminino, 75ml", img: "imagens/produtos/florattablue.png" },
            { id: 9, nome: "Floratta Flores Secretas", preco: 165, desc: "Feminino, 75ml", img: "imagens/produtos/florattaflores.png" },
            { id: 10, nome: "Floratta Red", preco: 165, desc: "Feminino, 75ml", img: "imagens/produtos/florattared.png" },
            { id: 11, nome: "Floratta Rose", preco: 165, desc: "Feminino, 75ml", img: "imagens/produtos/florattarose.png" },
            { id: 12, nome: "Lily Sérum", preco: 73, desc: "Acetinado capilar, 100ml", img: "imagens/produtos/acetcapilar.png"},
            { id: 13, nome: "Lily Creme (Recipiente)", preco:145 , desc:"Acetinado, Desodorante hidratante corporal", img: "imagens/produtos/acetinadorecipiente.png" },
            { id: 14, nome: "Lily Creme (Refil)", preco:100 , desc:"Acetinado, Desodorante hidratante corporal", img: "imagens/produtos/acetinadorefil.png" },
            //{ id: , nome: "", preco: , desc:"", img: "imagens/produtos/" },
        ];

        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        const body = document.querySelector('body');
        const listProductHTML = document.querySelector('.listProduct');
        const listCartHTML = document.querySelector('.listCart');
        const cartCount = document.querySelector('.icon-cart span');

        document.querySelector('.icon-cart').onclick = () => body.classList.toggle('showCart');
        document.querySelector('.close').onclick = () => body.classList.remove('showCart');

function showProducts(lista) {
            listProductHTML.innerHTML = ''; 
            lista.forEach(p => {
                let div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `
                    <img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'">
                    <h2>${p.nome}</h2>
                    <p style="font-size: 0.9rem; color: #ccc; margin-top: -10px; font-style: italic;">${p.desc}</p>
                    <div class="price">R$ ${p.preco},00</div>
                    <button onclick="addToCart(${p.id})">Adicionar</button>`;
                listProductHTML.appendChild(div);
            });
        }

        window.addToCart = (id) => {
            let pos = cart.findIndex(i => i.product_id == id);
            if (pos < 0) cart.push({ product_id: id, quantity: 1 });
            else cart[pos].quantity++;
            save();
        };

        window.changeQty = (id, delta) => {
            let pos = cart.findIndex(i => i.product_id == id);
            if (pos >= 0) {
                cart[pos].quantity += delta;
                if (cart[pos].quantity <= 0) cart.splice(pos, 1);
            }
            save();
        };

// Substitua sua função save por esta:
function save() {
    // Força a conversão para String para garantir que o ID seja lido corretamente depois
    localStorage.setItem('cart', JSON.stringify(cart));
    renderCart();
    console.log("Carrinho salvo com sucesso!", cart);
}
        

        function renderCart() {
            listCartHTML.innerHTML = '';
            let total = 0;
            cart.forEach(item => {
                let p = produtos.find(x => x.id == item.product_id);
                if (p) {
                    total += item.quantity;
                    let div = document.createElement('div');
                    div.className = 'item-cart';
                    div.innerHTML = `
                        <div class="name">${p.nome}</div>
                        <div class="totalPrice">R$ ${p.preco * item.quantity}</div>
                        <div class="quantity">
                            <span onclick="changeQty(${p.id},-1)">-</span>
                            <b>${item.quantity}</b>
                            <span onclick="changeQty(${p.id},1)">+</span>
                        </div>`;
                    listCartHTML.appendChild(div);
                }
            });
            cartCount.innerText = total;
        }

        document.querySelector('#searchInput').oninput = (e) => {
            let val = e.target.value.toLowerCase();
            showProducts(produtos.filter(p => p.nome.toLowerCase().includes(val)));
        };

        document.querySelector('.buy').onclick = () => {
    console.log("Carrinho atual:", cart); // Isso vai mostrar no F12 se o carrinho tem algo
    if(cart.length > 0) {
        window.location.href = 'compra.html';
    } else {
        alert("O carrinho está vazio no sistema!");
    }
};
        showProducts(produtos);
        renderCart();
    </script>
</body>
</html> 